##############################################################################
#                                                                            #
# IAR 8051 C/C++ Compiler V7.20H/W32                   22/Jun/2016  18:27:55 #
# Copyright 2004-2006 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Core               =  plain                                             #
#    Code model         =  banked                                            #
#    Data model         =  large                                             #
#    Calling convention =  extended stack reentrant                          #
#    Constant location  =  code                                              #
#    Extended stack     =  enabled                                           #
#    Dptr setup         =  1,16                                              #
#    Source file        =  E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\task\t #
#                          ask_STA350.c                                      #
#    Command line       =  -I "C:\Program Files\IAR Systems\Embedded         #
#                          Workbench 4.05 Evaluation version\8051\INC\" -I   #
#                          "C:\Program Files\IAR Systems\Embedded Workbench  #
#                          4.05 Evaluation version\8051\INC\CLIB\" -I        #
#                          E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\api\   #
#                          -I E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\dis #
#                          play\ -I E:\Juchen\CW6687G\JC_M_328_20160617_P0\A #
#                          PP\display\lcd\ -I E:\Juchen\CW6687G\JC_M_328_201 #
#                          60617_P0\APP\display\lcdseg\ -I                   #
#                          E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\displa #
#                          y\led\ -I E:\Juchen\CW6687G\JC_M_328_20160617_P0\ #
#                          APP\display\ledseg\ -I E:\Juchen\CW6687G\JC_M_328 #
#                          _20160617_P0\APP\display\no\ -I                   #
#                          E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\config #
#                          \ -I E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\c #
#                          ommon\ -I E:\Juchen\CW6687G\JC_M_328_20160617_P0\ #
#                          APP\task\ -I E:\Juchen\CW6687G\JC_M_328_20160617_ #
#                          P0\APP\user\ -I E:\Juchen\CW6687G\JC_M_328_201606 #
#                          17_P0\APP\user\mp3res\ -I                         #
#                          E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\btstac #
#                          k\ -I E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\ #
#                          user\user_config\ -I E:\Juchen\CW6687G\JC_M_328_2 #
#                          0160617_P0\APP\user\user_iis\ -lC                 #
#                          E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\Debug\ #
#                          List\ -o E:\Juchen\CW6687G\JC_M_328_20160617_P0\A #
#                          PP\Debug\Obj\ -e -z9 --debug --core=plain         #
#                          --dptr=16,1 --data_model=large                    #
#                          --code_model=banked --calling_convention=ext_stac #
#                          k_reentrant --place_constants=code                #
#                          --nr_virtual_regs 20 --extended_stack             #
#                          E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\task\t #
#                          ask_STA350.c                                      #
#    List file          =  E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\Debug\ #
#                          List\task_STA350.lst                              #
#    Object file        =  E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\Debug\ #
#                          Obj\task_STA350.r51                               #
#                                                                            #
#                                                                            #
##############################################################################

E:\Juchen\CW6687G\JC_M_328_20160617_P0\APP\task\task_STA350.c
      1          #include "include.h"

   \                                 In segment SFR_AN, at 0x80
   \   unsigned char volatile __sfr P0
   \                     P0:
   \   000000                DS 1

   \                                 In segment SFR_AN, at 0x90
   \   unsigned char volatile __sfr P1
   \                     P1:
   \   000000                DS 1

   \                                 In segment SFR_AN, at 0xba
   \   unsigned char volatile __sfr P0DIR
   \                     P0DIR:
   \   000000                DS 1

   \                                 In segment SFR_AN, at 0xbb
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
      2          #include "task.h"
      3          #include "user_setting.h"
      4          #include "task_STA350.h"
      5          #include "task_NPCP215X.h"
      6          
      7          #if ST350BW 
      8          
      9          #define  STA350ADDERSS	    0x3a
     10          
     11          #pragma location="STA350_DATA"

   \                                 In segment STA350_DATA, align 1
     12          const __code u16 Audio_Sub_VolumeData[33] =
   \                     Audio_Sub_VolumeData:
   \   000000   FF008C00     DW 255, 140, 101, 81, 65, 57, 49, 45, 41, 37, 33, 29, 27, 25, 21, 19
   \            65005100
   \            41003900
   \            31002D00
   \            29002500
   \            21001D00
   \            1B001900
   \            15001300
   \   000020   11000F00     DW 17, 15, 15, 13, 13, 11, 11, 9, 9, 7, 7, 5, 5, 3, 3, 0, 0
   \            0F000D00
   \            0D000B00
   \            0B000900
   \            09000700
   \            07000500
   \            05000300
   \            03000000
   \            0000    
     13          {
     14              0xff,0x8c,0x65,
     15              0x51,0x41,0x39,0x31,0x2d,0x29,0x25,0x21,0x1d,0x1b,
     16              0x19,0x15,0x13,0x11,0x0f,0x0f,0x0d,0x0d,0x0b,0x0b,
     17              0x09,0x09,0x07,0x07,0x05,0x05,0x03,0x03,0x00,0x00,//20.5db    
     18          #if 0
     19              0xff,0x8c,0x87,
     20              0x81,0x79,0x71,0x6d,0x5d,0x4d,0x43,0x37,0x31,0x2b,
     21              0x27,0x21,0x21,0x1f,0x1d,0x1d,0x19,0x13,0x0f,0x0d,
     22              0x0b,0x09,0x07,0x07,0x05,0x05,0x03,0x03,0x01,0x00,//20.5db
     23           
     24          #endif    
     25          };
     26          
     27          #pragma location="STA350_DATA"

   \                                 In segment STA350_DATA, align 1
     28          const __code u16 Audio_Sub_VolumeData1[33] =
   \                     Audio_Sub_VolumeData1:
   \   000000   FF008C00     DW 255, 140, 101, 81, 65, 57, 49, 45, 41, 37, 33, 29, 27, 25, 21, 19
   \            65005100
   \            41003900
   \            31002D00
   \            29002500
   \            21001D00
   \            1B001900
   \            15001300
   \   000020   11000F00     DW 17, 15, 15, 13, 13, 11, 11, 9, 9, 7, 7, 5, 5, 3, 3, 0, 0
   \            0F000D00
   \            0D000B00
   \            0B000900
   \            09000700
   \            07000500
   \            05000300
   \            03000000
   \            0000    
     29          {
     30              0xff,0x8c,0x65,
     31              0x51,0x41,0x39,0x31,0x2d,0x29,0x25,0x21,0x1d,0x1b,
     32              0x19,0x15,0x13,0x11,0x0f,0x0f,0x0d,0x0d,0x0b,0x0b,
     33              0x09,0x09,0x07,0x07,0x05,0x05,0x03,0x03,0x00,0x00,//20.5db  
     34          };
     35          
     36          #if 1
     37          #pragma location="STA350_DATA"

   \                                 In segment STA350_DATA, align 1
     38          const __code u8 sta350_ommands[214] =
   \                     sta350_ommands:
   \   000000   00630180     DB 0, 99, 1, 128, 2, 151, 3, 64, 4, 194, 5, 223, 6, 16, 7, 22, 8, 102
   \            02970340
   \            04C205DF
   \            06100716
   \            0866    
   \   000012   09660A66     DB 9, 102, 10, 102, 11, 128, 12, 0, 14, 0, 15, 64, 16, 144, 17, 119, 18
   \            0B800C00
   \            0E000F40
   \            10901177
   \            12      
   \   000023   69136914     DB 105, 19, 105, 20, 106, 21, 105, 22, 0, 23, 0, 24, 0, 25, 0, 26, 0
   \            6A156916
   \            00170018
   \            0019001A
   \            00      
   \   000034   1B001C00     DB 27, 0, 28, 0, 29, 0, 30, 0, 31, 0, 32, 0, 33, 0, 34, 0, 35, 0, 36, 0
   \            1D001E00
   \            1F002000
   \            21002200
   \            23002400
   \   000048   25002600     DB 37, 0, 38, 0, 39, 26, 40, 192, 41, 243, 42, 51, 43, 0, 44, 12, 45
   \            271A28C0
   \            29F32A33
   \            2B002C0C
   \            2D      
   \   000059   7F310032     DB 127, 49, 0, 50, 48, 51, 48, 52, 48, 53, 48, 54, 0, 55, 0, 56, 0, 57
   \            30333034
   \            30353036
   \            00370038
   \            0039    
   \   00006B   013AEE3B     DB 1, 58, 238, 59, 255, 60, 126, 61, 192, 62, 38, 63, 0, 72, 0, 73, 0
   \            FF3C7E3D
   \            C03E263F
   \            00480049
   \            00      
   \   00007C   4A004B04     DB 74, 0, 75, 4, 76, 0, 49, 1, 22, 55, 23, 90, 24, 157, 25, 247, 38, 1
   \            4C003101
   \            1637175A
   \            189D19F7
   \            2601    
   \   00008E   31011638     DB 49, 1, 22, 56, 23, 0, 24, 0, 25, 0, 38, 1, 49, 1, 22, 57, 23, 127
   \            17001800
   \            19002601
   \            31011639
   \            177F    
   \   0000A0   18FF19FF     DB 24, 255, 25, 255, 38, 1, 49, 1, 22, 58, 23, 127, 24, 255, 25, 255
   \            26013101
   \            163A177F
   \            18FF19FF
   \   0000B0   26013101     DB 38, 1, 49, 1, 22, 59, 23, 0, 24, 0, 25, 0, 38, 1, 49, 1, 22, 60, 23
   \            163B1700
   \            18001900
   \            26013101
   \            163C17  
   \   0000C3   80180019     DB 128, 24, 0, 25, 0, 38, 1, 49, 1, 22, 61, 23, 128, 24, 0, 25, 0, 38
   \            00260131
   \            01163D17
   \            80180019
   \            0026    
   \   0000D5   01           DB 1
     39          {    
     40              0x00, 0x63, //## Configuration Register A
     41              0x01, 0x80, //## Configuration Register B
     42              0x02, 0x97, //## Configuration Register C
     43              0x03, 0x40, //## Configuration Register D
     44              0x04, 0xC2, //## Configuration Register E
     45              0x05, 0xdf, //## Configuration Register F
     46              0x06, 0x10, //## Master Mute
     47              0x07, 0x16, //## Master Volume    
     48              0x08, 0x66, //## Channel 1 Volume //-3dB
     49              0x09, 0x66, //## Channel 2 Volume //-3dB
     50              0x0A, 0x66, //## Channel 3 Volume //-3dB
     51              0x0B, 0x80, //## Audio Preset Register 1
     52              0x0C, 0x00, //## Audio Preset Register 2
     53              0x0E, 0x00, //## Channel 1 Config
     54              0x0F, 0x40, //## Channel 2 Config
     55              0x10, 0x90, //## Channel 3 Config
     56              0x11, 0x77, //## Bass and Treble Tone Control
     57              0x12, 0x69, //## Limiter 1 Attack/Release Rate
     58              0x13, 0x69, //## Limiter 1 Attack/Release Threshold
     59              0x14, 0x6A, //## Limiter 2 Attack/Release Rate
     60              0x15, 0x69, //## Limiter 2 Attack/Release Threshold
     61              0x16, 0x00, //## Coefficient Address Bits 5..0
     62              0x17, 0x00, //## Coefficient b1 Data Bits 23..16
     63              0x18, 0x00, //## Coefficient b1 Data Bits 15..8
     64              0x19, 0x00, //## Coefficient b1 Data Bits 7..0
     65              0x1A, 0x00, //## Coefficient b2 Data Bits 23..16
     66              0x1B, 0x00, //## Coefficient b2 Data Bits 15..8
     67              0x1C, 0x00, //## Coefficient b2 Data Bits 7..0
     68              0x1D, 0x00, //## Coefficient a1 Data Bits 23..16
     69              0x1E, 0x00, //## Coefficient a1 Data Bits 15..8
     70              0x1F, 0x00, //## Coefficient a1 Data Bits 7..0
     71              0x20, 0x00, //## Coefficient a2 Data Bits 23..16
     72              0x21, 0x00, //## Coefficient a2 Data Bits 15..8
     73              0x22, 0x00, //## Coefficient a2 Data Bits 7..0
     74              0x23, 0x00, //## Coefficient b0 Data Bits 23..16
     75              0x24, 0x00, //## Coefficient b0 Data Bits 15..8
     76              0x25, 0x00, //## Coefficient b0 Data Bits 7..0
     77              0x26, 0x00, //## Coefficient Write Control
     78              0x27, 0x1A, //## Max Power Correction Config Msb
     79              0x28, 0xC0, //## Max Power Correction Config Lsb
     80              0x29, 0xF3, //## Variable Distortion Compensation Msb
     81              0x2A, 0x33, //## Variable Distortion Compensation Lsb
     82              0x2B, 0x00, //## Fault Detect Recovery Bits Msb
     83              0x2C, 0x0C, //## Fault Detect Recovery Bits Lsb
     84              0x2D, 0x7F, //## Device Status
     85              0x31, 0x00, //## EQ Coeff and DRC Configuration
     86              0x32, 0x30, //## Limiter 1 Ext.Attack Threshold
     87              0x33, 0x30, //## Limiter 1 Ext.Release Threshold
     88              0x34, 0x30, //## Limiter 2 Ext.Attack Threshold
     89              0x35, 0x30, //## Limiter 2 Ext.Release Threshold
     90              0x36, 0x00, //## Extended Configuraton Register
     91              0x37, 0x00, //## EQ Soft Volume Config (fade-in)
     92              0x38, 0x00, //## EQ Soft Volume Config (fade-out)
     93              0x39, 0x01, //## DRC RMS Filter Coefficient C0 Bits 25..16
     94              0x3A, 0xEE, //## DRC RMS Filter Coefficient C0 Bits 15..8
     95              0x3B, 0xFF, //## DRC RMS Filter Coefficient C0 Bits 7..0
     96              0x3C, 0x7E, //## DRC RMS Filter Coefficient C1 Bits 25..16
     97              0x3D, 0xC0, //## DRC RMS Filter Coefficient C1 Bits 15..8
     98              0x3E, 0x26, //## DRC RMS Filter Coefficient C1 Bits 7..0
     99              0x3F, 0x00, //## Extended Volume Resolution
    100              0x48, 0x00, //## Noise Shaping
    101              0x49, 0x00, //## Extended Coef Range 4-1
    102              0x4A, 0x00, //## Extended Coef Range 7-5
    103              0x4B, 0x04, //## Miscellaneous 1
    104              0x4C, 0x00, //## Miscellaneous 2  
    105          #if 0       
    106              0x31, 0x01,  //Coef[032h] = 7FFFFFh ## Coefficient 0x32 - Channel 1 Pre-scale
    107              0x16, 0x32,
    108              0x17, 0x7f,
    109              0x18, 0xff,
    110              0x19, 0xff,
    111              0x26, 0x01,
    112          
    113              0x31, 0x01,  //Coef[033h] = 7FFFFFh ## Coefficient 0x33 - Channel 2 Pre-scale
    114              0x16, 0x33,
    115              0x17, 0x7f,
    116              0x18, 0xff,
    117              0x19, 0xff,
    118              0x26, 0x01,
    119              
    120              0x31, 0x01, //Coef[034h] = 7FFFFFh ## Coefficient 0x35 - Channel 2 Post-scale
    121              0x16, 0x34,
    122              0x17, 0x7f,
    123              0x18, 0xff,
    124              0x19, 0xff,
    125              0x26, 0x01,
    126              
    127              0x31, 0x01, //Coef[035h] = 7FFFFFh ## Coefficient 0x35 - Channel 2 Post-scale
    128              0x16, 0x35,
    129              0x17, 0x7f,
    130              0x18, 0xff,
    131              0x19, 0xff,
    132              0x26, 0x01,
    133              
    134              0x31, 0x01, //Coef[036h] = 7FFFFFh ## Coefficient 0x36 - Channel 3 Post-scale 
    135              0x16, 0x36,
    136              0x17, 0x7f,
    137              0x18, 0xff,
    138              0x19, 0xff,
    139              0x26, 0x01,
    140          #endif    
    141              0x31, 0x01, //Coef[037h] = 5A9DF7h ## Coefficient 0x37 - Twarn/Oc Limit
    142              0x16, 0x37,
    143              0x17, 0x5A,
    144              0x18, 0x9D,
    145              0x19, 0xF7,
    146              0x26, 0x01,
    147              
    148              0x31, 0x01, //Coef[038h] = 000000h ## Coefficient 0x38 - Channel 1 Mix 1
    149              0x16, 0x38,
    150              0x17, 0x00,
    151              0x18, 0x00,
    152              0x19, 0x00,
    153              0x26, 0x01,
    154          
    155              0x31, 0x01, //Coef[039h] = 7FFFFFh ## Coefficient 0x39 - Channel 1 Mix 2
    156              0x16, 0x39,
    157              0x17, 0x7f,
    158              0x18, 0xff,
    159              0x19, 0xff,
    160              0x26, 0x01,
    161              
    162              0x31, 0x01, //Coef[03Ah] = 7FFFFFh ## Coefficient 0x3A - Channel 2 Mix 1
    163              0x16, 0x3a,
    164              0x17, 0x7f,
    165              0x18, 0xff,
    166              0x19, 0xff,
    167              0x26, 0x01,
    168              
    169              0x31, 0x01, //Coef[03Bh] = 000000h ## Coefficient 0x3B - Channel 2 Mix 2
    170              0x16, 0x3b, 
    171              0x17, 0x00,
    172              0x18, 0x00,
    173              0x19, 0x00,
    174              0x26, 0x01,
    175          
    176              0x31, 0x01, //Coef[03Ch] = 200000h ## Coefficient 0x3C - Channel 3 Mix 1
    177              0x16, 0x3c,
    178              0x17, 0x80,
    179              0x18, 0x00,
    180              0x19, 0x00,
    181              0x26, 0x01,
    182              
    183              0x31, 0x01, //Coef[03Dh] = 200000h ## Coefficient 0x3D - Channel 3 Mix 2
    184              0x16, 0x3d,
    185              0x17, 0x80,
    186              0x18, 0x00,
    187              0x19, 0x00,
    188              0x26, 0x01,
    189          };
    190          #endif
    191          
    192          #pragma location="CS8416_IIC_API"

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
    193          void Audio_out_I2C_Start(void)
   \                     Audio_out_I2C_Start:
    194          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    195          	ST350_DATA_OUTPUT;
   \   000000   12....       LCALL   ?Subroutine2
    196          	ST350_CLK_OUTPUT;
   \                     ??CrossCallReturnLabel_5:
   \   000003   53BBEF       ANL     0xbb,#0xef
   \   000006   D294         SETB    0x90.4
    197          	ST350_DATA_HIGH;
   \   000008   D286         SETB    0x80.6
    198          	ST350_CLK_HIGH;
   \   00000A   D294         SETB    0x90.4
    199              delay(30);
   \   00000C                ; Setup parameters for call to function delay
   \   00000C   7A1E         MOV     R2,#0x1e
   \   00000E   7B00         MOV     R3,#0x0
   \   000010   12....       LCALL   delay & 0xFFFF
    200          	ST350_DATA_LOW;
   \   000013   C286         CLR     0x80.6
    201              delay(30);
   \   000015                ; Setup parameters for call to function delay
   \   000015   7A1E         MOV     R2,#0x1e
   \   000017   7B00         MOV     R3,#0x0
   \   000019   12....       LCALL   delay & 0xFFFF
    202          	ST350_CLK_LOW;
   \   00001C   C294         CLR     0x90.4
    203          	//Delay_myself;
    204          	//TA5731_DATA_HIGH;
    205          }
   \   00001E   02....       LJMP    ?BRET

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   53BABF       ANL     0xba,#0xbf
   \   000003   D286         SETB    0x80.6
   \   000005   22           RET
    206          #pragma location="CS8416_IIC_API"

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
    207          void Audio_out_I2C_SendByte(u8 Data)
   \                     Audio_out_I2C_SendByte:
    208          {
   \   000000   EE           MOV     A,R6
   \   000001   C0E0         PUSH    A
   \   000003   EF           MOV     A,R7
   \   000004   C0E0         PUSH    A
   \   000006                ; Saved register size: 2
   \   000006                ; Auto size: 0
   \   000006   E9           MOV     A,R1
   \   000007   FF           MOV     R7,A
    209          	u8 i;
    210          	
    211              //delay(30);
    212          	ST350_DATA_OUTPUT;	
   \   000008   12....       LCALL   ?Subroutine2
    213          	for(i = 0;i < 8;i++)
   \                     ??CrossCallReturnLabel_6:
   \   00000B   7E08         MOV     R6,#0x8
    214          	{
    215          		if(Data & 0x80) ST350_DATA_HIGH;
   \                     ??Audio_out_I2C_SendByte_0:
   \   00000D   EF           MOV     A,R7
   \   00000E   A2E7         MOV     C,0xE0 /* A   */.7
   \   000010   5004         JNC     ??Audio_out_I2C_SendByte_1
   \   000012   D286         SETB    0x80.6
   \   000014   8002         SJMP    ??Audio_out_I2C_SendByte_2
    216          		else			ST350_DATA_LOW;
   \                     ??Audio_out_I2C_SendByte_1:
   \   000016   C286         CLR     0x80.6
    217          		delay(30);
   \                     ??Audio_out_I2C_SendByte_2:
   \   000018                ; Setup parameters for call to function delay
   \   000018   12....       LCALL   ?Subroutine0
    218          		ST350_CLK_HIGH;
    219          		delay(30);
    220          		Data <<= 1;
   \                     ??CrossCallReturnLabel_0:
   \   00001B   EF           MOV     A,R7
   \   00001C   C3           CLR     C
   \   00001D   33           RLC     A
   \   00001E   FF           MOV     R7,A
    221          		ST350_CLK_LOW;
   \   00001F   C294         CLR     0x90.4
    222          	}
   \   000021   1E           DEC     R6
   \   000022   EE           MOV     A,R6
   \   000023   70E8         JNZ     ??Audio_out_I2C_SendByte_0
    223          }
   \   000025                REQUIRE ?Subroutine3
   \   000025                ; // Fall through to label ?Subroutine3

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   D0E0         POP     A
   \   000002   FF           MOV     R7,A
   \                     ??Subroutine3_0:
   \   000003   D0E0         POP     A
   \   000005   FE           MOV     R6,A
   \   000006   02....       LJMP    ?BRET

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7A1E         MOV     R2,#0x1e
   \   000002   7B00         MOV     R3,#0x0
   \   000004   12....       LCALL   delay & 0xFFFF
   \   000007   D294         SETB    0x90.4
   \   000009                ; Setup parameters for call to function delay
   \   000009                ; Setup parameters for call to function delay
   \   000009                ; Setup parameters for call to function delay
   \   000009   7A1E         MOV     R2,#0x1e
   \   00000B   7B00         MOV     R3,#0x0
   \   00000D   12....       LCALL   delay & 0xFFFF
   \   000010   22           RET
    224          
    225          #pragma location="CS8416_IIC_API"

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
    226          bool Audio_out_ReceiveACK(void)
   \                     Audio_out_ReceiveACK:
    227          {
   \   000000   C0..         PUSH    ?VB
   \   000002                ; Saved register size: 1
   \   000002                ; Auto size: 0
    228              bool Ackflag = false;
    229          	
    230          	ST350_DATA_INPUT;
   \   000002   43BA40       ORL     0xba,#0x40
    231              delay(30);
   \   000005                ; Setup parameters for call to function delay
   \   000005   12....       LCALL   ?Subroutine0
    232          	ST350_CLK_HIGH;
    233              delay(30);
    234          	
    235          	if(ST350_DATA) 
   \                     ??CrossCallReturnLabel_1:
   \   000008   A286         MOV     C,0x80.6
   \   00000A   5007         JNC     ??Audio_out_ReceiveACK_0
    236              {   
    237                  ST350_DATA_OUTPUT;
   \   00000C   12....       LCALL   ?Subroutine2
    238          		Ackflag = 1;
   \                     ??CrossCallReturnLabel_7:
   \   00000F   D2..         SETB    ?VB.0
   \   000011   8002         SJMP    ??Audio_out_ReceiveACK_1
    239              }
    240          	else 
    241          		Ackflag = 0;
   \                     ??Audio_out_ReceiveACK_0:
   \   000013   C2..         CLR     ?VB.0
    242          	
    243          	ST350_CLK_LOW;
   \                     ??Audio_out_ReceiveACK_1:
   \   000015   C294         CLR     0x90.4
    244          		
    245              delay(30);
   \   000017                ; Setup parameters for call to function delay
   \   000017   7A1E         MOV     R2,#0x1e
   \   000019   7B00         MOV     R3,#0x0
   \   00001B   12....       LCALL   delay & 0xFFFF
    246          
    247          	return Ackflag;
   \   00001E   A2..         MOV     C,?VB.0
   \   000020   D0..         POP     ?VB
   \   000022   02....       LJMP    ?BRET
    248          }
    249          
    250          #pragma location="CS8416_IIC_API"

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
    251          void Audio_out_I2C_Stop(void)
   \                     Audio_out_I2C_Stop:
    252          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    253          	ST350_DATA_OUTPUT;
   \   000000   12....       LCALL   ?Subroutine2
    254          	ST350_DATA_LOW;
   \                     ??CrossCallReturnLabel_8:
   \   000003   C286         CLR     0x80.6
    255              delay(30);
   \   000005                ; Setup parameters for call to function delay
   \   000005   12....       LCALL   ?Subroutine0
    256          	ST350_CLK_HIGH;
    257              delay(30);
    258          	ST350_DATA_HIGH;
   \                     ??CrossCallReturnLabel_2:
   \   000008   D286         SETB    0x80.6
    259              delay(30);
   \   00000A                ; Setup parameters for call to function delay
   \   00000A   7A1E         MOV     R2,#0x1e
   \   00000C   7B00         MOV     R3,#0x0
   \   00000E   12....       LCALL   delay & 0xFFFF
    260          }
   \   000011   02....       LJMP    ?BRET
    261          
    262          #pragma location="CS8416_IIC_API"

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
    263          void Audio_out_I2C_WriteByte(u8 adr,u8 volume)	//const 
   \                     Audio_out_I2C_WriteByte:
    264          {
   \   000000   EE           MOV     A,R6
   \   000001   C0E0         PUSH    A
   \   000003   EF           MOV     A,R7
   \   000004   C0E0         PUSH    A
   \   000006                ; Saved register size: 2
   \   000006                ; Auto size: 0
   \   000006   E9           MOV     A,R1
   \   000007   FE           MOV     R6,A
   \   000008   EA           MOV     A,R2
   \   000009   FF           MOV     R7,A
    265              Audio_out_I2C_Start();
   \   00000A                ; Setup parameters for call to function Audio_out_I2C_Start
   \   00000A   90....       MOV     DPTR,#(Audio_out_I2C_Start & 0xffff)
   \   00000D   74..         MOV     A,#((Audio_out_I2C_Start >> 16) & 0xff)
   \   00000F   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    266              Audio_out_I2C_SendByte(STA350ADDERSS);
   \   000012                ; Setup parameters for call to function Audio_out_I2C_SendByte
   \   000012   793A         MOV     R1,#0x3a
   \   000014   90....       MOV     DPTR,#(Audio_out_I2C_SendByte & 0xffff)
   \   000017   74..         MOV     A,#((Audio_out_I2C_SendByte >> 16) & 0xff)
   \   000019   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    267              Audio_out_ReceiveACK();
   \   00001C                ; Setup parameters for call to function Audio_out_ReceiveACK
   \   00001C   90....       MOV     DPTR,#(Audio_out_ReceiveACK & 0xffff)
   \   00001F   74..         MOV     A,#((Audio_out_ReceiveACK >> 16) & 0xff)
   \   000021   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    268              Audio_out_I2C_SendByte(adr);
   \   000024                ; Setup parameters for call to function Audio_out_I2C_SendByte
   \   000024   EE           MOV     A,R6
   \   000025   F9           MOV     R1,A
   \   000026   90....       MOV     DPTR,#(Audio_out_I2C_SendByte & 0xffff)
   \   000029   74..         MOV     A,#((Audio_out_I2C_SendByte >> 16) & 0xff)
   \   00002B   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    269              Audio_out_ReceiveACK();
   \   00002E                ; Setup parameters for call to function Audio_out_ReceiveACK
   \   00002E   90....       MOV     DPTR,#(Audio_out_ReceiveACK & 0xffff)
   \   000031   74..         MOV     A,#((Audio_out_ReceiveACK >> 16) & 0xff)
   \   000033   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    270              Audio_out_I2C_SendByte(volume);
   \   000036                ; Setup parameters for call to function Audio_out_I2C_SendByte
   \   000036   EF           MOV     A,R7
   \   000037   F9           MOV     R1,A
   \   000038   90....       MOV     DPTR,#(Audio_out_I2C_SendByte & 0xffff)
   \   00003B   74..         MOV     A,#((Audio_out_I2C_SendByte >> 16) & 0xff)
   \   00003D   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    271              Audio_out_ReceiveACK();
   \   000040                ; Setup parameters for call to function Audio_out_ReceiveACK
   \   000040   90....       MOV     DPTR,#(Audio_out_ReceiveACK & 0xffff)
   \   000043   74..         MOV     A,#((Audio_out_ReceiveACK >> 16) & 0xff)
   \   000045   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    272              Audio_out_I2C_Stop();
   \   000048                ; Setup parameters for call to function Audio_out_I2C_Stop
   \   000048   90....       MOV     DPTR,#(Audio_out_I2C_Stop & 0xffff)
   \   00004B   74..         MOV     A,#((Audio_out_I2C_Stop >> 16) & 0xff)
   \   00004D   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    273          }
   \   000050   02....       LJMP    ?Subroutine3
    274          
    275          #pragma location="CS8416_IIC_API"

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
    276          void sta350_Init(void)
   \                     sta350_Init:
    277          { 
   \   000000   EE           MOV     A,R6
   \   000001   C0E0         PUSH    A
   \   000003   C0..         PUSH    ?V0 + 0
   \   000005   C0..         PUSH    ?V0 + 1
   \   000007                ; Saved register size: 3
   \   000007                ; Auto size: 0
    278              u8 i;
    279              for(i = 0 ;i< sizeof(sta350_ommands);i++)
   \   000007   7E00         MOV     R6,#0x0
    280              {     
    281                  Audio_out_I2C_Start();                //IICÆô¶¯
   \                     ??sta350_Init_0:
   \   000009                ; Setup parameters for call to function Audio_out_I2C_Start
   \   000009   90....       MOV     DPTR,#(Audio_out_I2C_Start & 0xffff)
   \   00000C   74..         MOV     A,#((Audio_out_I2C_Start >> 16) & 0xff)
   \   00000E   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    282                  Audio_out_I2C_SendByte(STA350ADDERSS);
   \   000011                ; Setup parameters for call to function Audio_out_I2C_SendByte
   \   000011   793A         MOV     R1,#0x3a
   \   000013   90....       MOV     DPTR,#(Audio_out_I2C_SendByte & 0xffff)
   \   000016   74..         MOV     A,#((Audio_out_I2C_SendByte >> 16) & 0xff)
   \   000018   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    283                  Audio_out_ReceiveACK();
   \   00001B                ; Setup parameters for call to function Audio_out_ReceiveACK
   \   00001B   90....       MOV     DPTR,#(Audio_out_ReceiveACK & 0xffff)
   \   00001E   74..         MOV     A,#((Audio_out_ReceiveACK >> 16) & 0xff)
   \   000020   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    284                  Audio_out_I2C_SendByte(sta350_ommands[i]);
   \   000023                ; Setup parameters for call to function Audio_out_I2C_SendByte
   \   000023   8E..         MOV     ?V0 + 0,R6
   \   000025   E5..         MOV     A,?V0 + 0
   \   000027   12....       LCALL   ?Subroutine1
   \                     ??CrossCallReturnLabel_3:
   \   00002A   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    285                  Audio_out_ReceiveACK();
   \   00002D                ; Setup parameters for call to function Audio_out_ReceiveACK
   \   00002D   90....       MOV     DPTR,#(Audio_out_ReceiveACK & 0xffff)
   \   000030   74..         MOV     A,#((Audio_out_ReceiveACK >> 16) & 0xff)
   \   000032   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    286                  Audio_out_I2C_SendByte(sta350_ommands[++i]);
   \   000035   0E           INC     R6
   \   000036                ; Setup parameters for call to function Audio_out_I2C_SendByte
   \   000036   EE           MOV     A,R6
   \   000037   12....       LCALL   ?Subroutine1
   \                     ??CrossCallReturnLabel_4:
   \   00003A   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    287                  Audio_out_ReceiveACK();
   \   00003D                ; Setup parameters for call to function Audio_out_ReceiveACK
   \   00003D   90....       MOV     DPTR,#(Audio_out_ReceiveACK & 0xffff)
   \   000040   74..         MOV     A,#((Audio_out_ReceiveACK >> 16) & 0xff)
   \   000042   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    288                  Audio_out_I2C_Stop();     // Stop and return         
   \   000045                ; Setup parameters for call to function Audio_out_I2C_Stop
   \   000045   90....       MOV     DPTR,#(Audio_out_I2C_Stop & 0xffff)
   \   000048   74..         MOV     A,#((Audio_out_I2C_Stop >> 16) & 0xff)
   \   00004A   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    289              }                       
   \   00004D   0E           INC     R6
   \   00004E   EE           MOV     A,R6
   \   00004F   C3           CLR     C
   \   000050   94D6         SUBB    A,#-0x2a
   \   000052   40B5         JC      ??sta350_Init_0
    290          }
   \   000054   D0..         POP     ?V0 + 1
   \   000056   D0..         POP     ?V0 + 0
   \   000058   02....       LJMP    ??Subroutine3_0

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   24..         ADD     A,#(sta350_ommands & 0xff)
   \   000002   F582         MOV     DPL,A
   \   000004   E4           CLR     A
   \   000005   34..         ADDC    A,#((sta350_ommands >> 8) & 0xff)
   \   000007   F583         MOV     DPH,A
   \   000009   E4           CLR     A
   \   00000A   93           MOVC    A,@A+DPTR
   \   00000B   F9           MOV     R1,A
   \   00000C   90....       MOV     DPTR,#(Audio_out_I2C_SendByte & 0xffff)
   \   00000F   74..         MOV     A,#((Audio_out_I2C_SendByte >> 16) & 0xff)
   \   000011   22           RET
    291          
    292          #pragma location="CS8416_IIC_API"

   \                                 In segment CS8416_IIC_API, align 1, keep-with-next
    293          void Set_Sub_Volume(u8 volume)	  
   \                     Set_Sub_Volume:
    294          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    295              Audio_out_I2C_WriteByte(0x07,Audio_Sub_VolumeData[volume]);
   \   000000                ; Setup parameters for call to function Audio_out_I2C_WriteByte
   \   000000   E9           MOV     A,R1
   \   000001   C3           CLR     C
   \   000002   33           RLC     A
   \   000003   F8           MOV     R0,A
   \   000004   E4           CLR     A
   \   000005   33           RLC     A
   \   000006   F9           MOV     R1,A
   \   000007   E8           MOV     A,R0
   \   000008   24..         ADD     A,#(Audio_Sub_VolumeData & 0xff)
   \   00000A   F582         MOV     DPL,A
   \   00000C   E9           MOV     A,R1
   \   00000D   34..         ADDC    A,#((Audio_Sub_VolumeData >> 8) & 0xff)
   \   00000F   F583         MOV     DPH,A
   \   000011   E4           CLR     A
   \   000012   93           MOVC    A,@A+DPTR
   \   000013   FA           MOV     R2,A
   \   000014   7907         MOV     R1,#0x7
   \   000016   90....       MOV     DPTR,#(Audio_out_I2C_WriteByte & 0xffff)
   \   000019   74..         MOV     A,#((Audio_out_I2C_WriteByte >> 16) & 0xff)
   \   00001B   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    296          #if 0
    297              if((task_ctl.work_sta == TASK_MUSIC)||(task_ctl.work_sta == TASK_BT))
    298              {
    299                  Audio_out_I2C_WriteByte(0x07,Audio_Sub_VolumeData[volume]); 
    300              }
    301              else 
    302              {
    303                  Audio_out_I2C_WriteByte(0x07,Audio_Sub_VolumeData1[volume]); 
    304              }
    305          #endif    
    306          }
   \   00001E   02....       LJMP    ?BRET
    307          
    308          #endif

   Maximum stack usage in bytes:

     Function                     EXT_STACK PSTACK XSTACK
     --------                     --------- ------ ------
     Audio_out_I2C_SendByte              5      0      0
       -> delay                          4      0      0
       -> delay                          4      0      0
     Audio_out_I2C_Start                 3      0      0
       -> delay                          0      0      0
       -> delay                          0      0      0
     Audio_out_I2C_Stop                  3      0      0
       -> delay                          0      0      0
       -> delay                          0      0      0
       -> delay                          0      0      0
     Audio_out_I2C_WriteByte             2      0      0
       -> Audio_out_I2C_Start            4      0      0
       -> Audio_out_I2C_SendByte         4      0      0
       -> Audio_out_ReceiveACK           4      0      0
       -> Audio_out_I2C_SendByte         4      0      0
       -> Audio_out_ReceiveACK           4      0      0
       -> Audio_out_I2C_SendByte         4      0      0
       -> Audio_out_ReceiveACK           4      0      0
       -> Audio_out_I2C_Stop             4      0      0
     Audio_out_ReceiveACK                4      0      0
       -> delay                          2      0      0
       -> delay                          2      0      0
       -> delay                          2      0      0
     Set_Sub_Volume                      0      0      0
       -> Audio_out_I2C_WriteByte        0      0      0
     sta350_Init                         3      0      0
       -> Audio_out_I2C_Start            6      0      0
       -> Audio_out_I2C_SendByte         6      0      0
       -> Audio_out_ReceiveACK           6      0      0
       -> Audio_out_I2C_SendByte         6      0      0
       -> Audio_out_ReceiveACK           6      0      0
       -> Audio_out_I2C_SendByte         6      0      0
       -> Audio_out_ReceiveACK           6      0      0
       -> Audio_out_I2C_Stop             6      0      0


   Segment part sizes:

     Function/Label          Bytes
     --------------          -----
     P0                         1
     P1                         1
     P0DIR                      1
     P1DIR                      1
     Audio_Sub_VolumeData      66
     Audio_Sub_VolumeData1     66
     sta350_ommands           214
     Audio_out_I2C_Start       33
     ?Subroutine2               6
     Audio_out_I2C_SendByte    37
     ?Subroutine3               9
     ?Subroutine0              17
     Audio_out_ReceiveACK      37
     Audio_out_I2C_Stop        20
     Audio_out_I2C_WriteByte   83
     sta350_Init               91
     ?Subroutine1              18
     Set_Sub_Volume            33

 
 384 bytes in segment CS8416_IIC_API
   4 bytes in segment SFR_AN
 346 bytes in segment STA350_DATA
 
 730 bytes of CODE memory
   0 bytes of DATA memory (+ 4 bytes shared)

Errors: none
Warnings: none
